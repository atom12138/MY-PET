(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-medical-list"],{"10eb":function(n,t,r){var e=r("c86c");t=e(!1),t.push([n.i,"\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/* åŸºç¡€å¸ƒå±€ */.content[data-v-292e8b16]{min-height:100vh;display:flex;align-items:flex-start;justify-content:center;padding:0;box-sizing:border-box;overflow:visible;background-color:#f5f5f5;width:100vw}.box[data-v-292e8b16]{width:100%;background:hsla(0,0%,100%,.9);border-radius:%?24?%;padding:%?32?%;box-shadow:0 %?12?% %?40?% rgba(0,0,0,.08);-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px)}\r\n/* æœç´¢æ  */.search-section[data-v-292e8b16]{margin-bottom:%?30?%}.search-box[data-v-292e8b16]{display:flex;align-items:center;background-color:#fff;border-radius:%?50?%;padding:%?20?% %?30?%;box-shadow:0 %?2?% %?10?% rgba(0,0,0,.1)}.search-input[data-v-292e8b16]{flex:1;margin-left:%?20?%;font-size:%?28?%}\r\n/* ç§‘å®¤åˆ†ç±» */.department-section[data-v-292e8b16]{background-color:#fff;border-radius:%?20?%;padding:%?30?%;margin-bottom:%?30?%;box-shadow:0 %?2?% %?10?% rgba(0,0,0,.1)}.section-title[data-v-292e8b16]{font-size:%?32?%;font-weight:700;margin-bottom:%?30?%;color:#333;display:flex;justify-content:space-between;align-items:center}.manage-btn[data-v-292e8b16]{background-color:#2196f3;color:#fff;border:none;border-radius:%?20?%;padding:%?10?% %?20?%;font-size:%?24?%;height:%?60?%;line-height:%?60?%}\r\n/* åŒ»ç”Ÿæ¶ˆæ¯ä¸­å¿ƒ */.doctor-message-center[data-v-292e8b16]{background-color:#fff;border-radius:%?20?%;padding:%?30?%;margin-bottom:%?30?%;box-shadow:0 %?2?% %?10?% rgba(0,0,0,.1)}.message-list[data-v-292e8b16]{display:flex;flex-direction:column;gap:%?20?%}.message-item[data-v-292e8b16]{padding:%?20?%;border:%?1?% solid #eee;border-radius:%?15?%;background-color:#fafafa}.patient-name[data-v-292e8b16]{font-size:%?30?%;font-weight:700;color:#2196f3;margin-bottom:%?8?%;display:block}.message-preview[data-v-292e8b16]{font-size:%?26?%;color:#666;margin-top:%?5?%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.message-time[data-v-292e8b16]{font-size:%?22?%;color:#999;margin-top:%?5?%}.no-message[data-v-292e8b16]{text-align:center;color:#999;padding:%?40?% 0}.department-scroll[data-v-292e8b16]{white-space:nowrap}.department-list[data-v-292e8b16]{display:flex;padding:%?10?% 0}.department-item[data-v-292e8b16]{display:flex;flex-direction:column;align-items:center;margin-right:%?40?%;padding:%?20?%;border-radius:%?15?%;transition:all .3s}.department-item.active[data-v-292e8b16]{background-color:#e3f2fd}.department-icon[data-v-292e8b16]{width:%?80?%;height:%?80?%;margin-bottom:%?15?%;font-size:%?60?%;display:flex;align-items:center;justify-content:center}.department-name[data-v-292e8b16]{font-size:%?24?%;color:#666;white-space:nowrap}\r\n/* åŒ»ç”Ÿåˆ—è¡¨ */.doctor-section[data-v-292e8b16]{background-color:#fff;border-radius:%?20?%;padding:%?30?%;box-shadow:0 %?2?% %?10?% rgba(0,0,0,.1)}.doctor-list[data-v-292e8b16]{display:flex;flex-direction:column;gap:%?30?%}.doctor-item[data-v-292e8b16]{display:flex;align-items:center;padding:%?30?%;border:%?1?% solid #eee;border-radius:%?15?%;background-color:#fafafa}.doctor-avatar[data-v-292e8b16]{width:%?120?%;height:%?120?%;border-radius:%?60?%;margin-right:%?30?%;display:flex;align-items:center;justify-content:center;background-color:#f0f0f0}.doctor-avatar-img[data-v-292e8b16]{width:100%;height:100%;border-radius:%?60?%}.doctor-avatar-fallback[data-v-292e8b16]{font-size:%?80?%}.doctor-info[data-v-292e8b16]{flex:1}.doctor-name[data-v-292e8b16]{font-size:%?32?%;font-weight:700;color:#333;margin-bottom:%?10?%;display:flex;align-items:center}.online-status[data-v-292e8b16]{margin-left:%?15?%;padding:%?5?% %?15?%;background-color:#4caf50;color:#fff;border-radius:%?15?%;font-size:%?22?%;font-weight:400}.offline-status[data-v-292e8b16]{margin-left:%?15?%;padding:%?5?% %?15?%;background-color:#f44336;color:#fff;border-radius:%?15?%;font-size:%?22?%;font-weight:400}.doctor-title[data-v-292e8b16]{font-size:%?26?%;color:#666;margin-bottom:%?8?%}.doctor-department[data-v-292e8b16]{font-size:%?24?%;color:#999;margin-bottom:%?8?%}.doctor-specialty[data-v-292e8b16]{font-size:%?22?%;color:#666;margin-bottom:%?15?%;line-height:1.4}.doctor-rating[data-v-292e8b16]{display:flex;align-items:center}.rating-text[data-v-292e8b16]{font-size:%?24?%;color:#ff9800;margin-left:%?15?%}.doctor-actions[data-v-292e8b16]{display:flex;flex-direction:column;gap:%?15?%}.action-btn[data-v-292e8b16]{padding:%?15?% %?25?%;border-radius:%?25?%;font-size:%?24?%;border:none}.chat-btn[data-v-292e8b16]{background-color:#2196f3;color:#fff}.appointment-btn[data-v-292e8b16]{background-color:#b49950;color:#fff}\r\n/* åœ¨çº¿é—®è¯Šå¼¹çª— */.chat-popup[data-v-292e8b16]{height:92vh;display:flex;flex-direction:column;background-color:#fff;border-radius:%?20?% %?20?% 0 0;padding-bottom:0;z-index:9999;margin-bottom:0}\r\n/* è§£é™¤ uni-popup åŒ…è£¹å®¹å™¨åœ¨å°ç¨‹åºç«¯å¯èƒ½çš„é«˜åº¦é™åˆ¶ */[data-v-292e8b16] .uni-popup__wrapper{max-height:100vh!important}[data-v-292e8b16] .uni-popup__wrapper-box{max-height:100vh!important}\r\n/* é¢„çº¦æŒ‚å·å¼¹çª— */.appointment-popup[data-v-292e8b16]{background-color:#fff;border-radius:%?20?% %?20?% 0 0;height:90vh;max-height:%?1050?%;display:flex;flex-direction:column;padding-bottom:calc(%?120?% + env(safe-area-inset-bottom));z-index:9999;margin-bottom:0;box-sizing:border-box}\r\n/* å“åº”å¼è°ƒæ•´ */@media screen and (max-height:700px){.chat-popup[data-v-292e8b16]{height:78vh}.appointment-popup[data-v-292e8b16]{height:85vh}}\r\n/* ç§»é™¤å†—ä½™çš„é¢å¤–å†…è¾¹è·ï¼Œé¿å…åº•éƒ¨åŒºåŸŸè¿‡é«˜ */\r\n/* é’ˆå¯¹iOSè®¾å¤‡çš„ç‰¹æ®Šå¤„ç† */@supports (padding-bottom:env(safe-area-inset-bottom)){.appointment-content[data-v-292e8b16]{padding-bottom:calc(%?100?% + env(safe-area-inset-bottom))}.chat-messages[data-v-292e8b16]{padding-bottom:calc(%?110?% + env(safe-area-inset-bottom))}.appointment-popup[data-v-292e8b16]{padding-bottom:calc(%?120?% + env(safe-area-inset-bottom))}}.chat-header[data-v-292e8b16]{display:flex;justify-content:space-between;align-items:center;padding:%?30?%;border-bottom:%?1?% solid #eee;position:-webkit-sticky;position:sticky;top:0;background:#fff;z-index:10001}.chat-title[data-v-292e8b16]{font-size:%?32?%;font-weight:700;color:#333}.chat-actions[data-v-292e8b16]{display:flex;align-items:center;gap:%?12?%}.clear-btn[data-v-292e8b16]{background-color:#f44336;color:#fff;border:none;border-radius:%?16?%;font-size:%?24?%;height:%?56?%;padding:0 %?24?%;display:inline-flex;align-items:center;justify-content:center;line-height:1}.clear-btn[data-v-292e8b16]::after{border:none}.chat-close[data-v-292e8b16]{font-size:%?40?%;color:#999;padding:%?10?%}.chat-content[data-v-292e8b16]{flex:1;display:flex;flex-direction:column;overflow:hidden;padding-bottom:calc(%?120?% + env(safe-area-inset-bottom))}.chat-messages[data-v-292e8b16]{flex:1;overflow-y:auto;padding:%?30?%;padding-bottom:%?200?%}.message-item[data-v-292e8b16]{margin-bottom:%?30?%;display:flex;flex-direction:column;gap:%?8?%}.message-content[data-v-292e8b16]{max-width:78%;padding:%?20?%;border-radius:%?15?%;font-size:%?28?%;word-wrap:break-word}\r\n/* å›¾ç‰‡æ¶ˆæ¯æ ·å¼ï¼Œé™åˆ¶å®½åº¦å¹¶ç»Ÿä¸€åœ†è§’ */.message-image[data-v-292e8b16]{max-width:60%;border-radius:%?12?%;margin-top:%?8?%;background:#f8f8f8;box-shadow:0 %?2?% %?10?% rgba(0,0,0,.06)}.message-left .message-content[data-v-292e8b16]{background-color:#f0f0f0;color:#333}.message-right .message-content[data-v-292e8b16]{background-color:#2196f3;color:#fff;margin-left:auto}.message-time[data-v-292e8b16]{font-size:%?22?%;color:#999;margin-top:%?10?%;text-align:center}.chat-input[data-v-292e8b16]{display:flex;align-items:center;gap:%?16?%;padding:%?16?% %?24?%;background-color:#fff;position:fixed;left:0;right:0;bottom:0;width:100vw;padding-bottom:calc(%?16?% + env(safe-area-inset-bottom));border-top:%?1?% solid #eee;box-shadow:0 %?-6?% %?20?% rgba(0,0,0,.06);z-index:10000}\r\n/* å¾®è°ƒå›¾æ ‡ä¸æ–‡æœ¬åŸºçº¿å¯¹é½ */.chat-input uni-icons[data-v-292e8b16]{opacity:.9;-webkit-transform:translateY(%?1?%);transform:translateY(%?1?%)}\r\n/* å°å±ä¼˜åŒ–ï¼šå‡å°‘æ°”æ³¡å®½åº¦ï¼Œå›¾ç‰‡æ›´æ”¶æ•› */@media screen and (max-width:375px){.message-content[data-v-292e8b16]{max-width:72%}.message-image[data-v-292e8b16]{max-width:55%}}.input-field[data-v-292e8b16]{flex:1;min-width:0;padding:%?24?%;border:%?1?% solid #ddd;border-radius:%?25?%;font-size:%?30?%;height:%?88?%}.send-btn[data-v-292e8b16]{padding:%?12?% %?20?%;background-color:#b49950;color:#fff;border:none;border-radius:%?20?%;font-size:%?26?%;min-height:%?64?%;height:%?64?%;white-space:nowrap;display:inline-flex;align-items:center}.appointment-header[data-v-292e8b16]{display:flex;justify-content:space-between;align-items:center;padding:%?30?%;border-bottom:%?1?% solid #eee}.appointment-title[data-v-292e8b16]{font-size:%?32?%;font-weight:700;color:#333}.appointment-close[data-v-292e8b16]{font-size:%?40?%;color:#999;padding:%?10?%}.appointment-content[data-v-292e8b16]{flex:1;padding:%?30?%;overflow-y:auto}.form-item[data-v-292e8b16]{margin-bottom:%?40?%}.form-label[data-v-292e8b16]{font-size:%?28?%;color:#333;margin-bottom:%?20?%}.picker-value[data-v-292e8b16]{padding:%?25?%;border:%?1?% solid #ddd;border-radius:%?10?%;font-size:%?28?%;color:#333}.symptom-input[data-v-292e8b16]{width:100%;height:%?200?%;padding:%?25?%;border:%?1?% solid #ddd;border-radius:%?10?%;font-size:%?28?%;color:#333}.submit-btn[data-v-292e8b16]{width:100%;padding:%?25?%;background-color:#b49950;color:#fff;border:none;border-radius:%?12?%;font-size:%?34?%;margin-top:%?40?%;height:%?88?%;line-height:%?88?%;display:flex;align-items:center;justify-content:center}\r\n/* å“åº”å¼è°ƒæ•´ */@media screen and (max-height:700px){.chat-popup[data-v-292e8b16]{height:78vh}.appointment-popup[data-v-292e8b16]{height:85vh}}\r\n/* ç¡®ä¿åœ¨å°å±å¹•è®¾å¤‡ä¸Šçš„æ˜¾ç¤ºæ•ˆæœ */@media screen and (max-width:375px){.chat-input[data-v-292e8b16]{padding:%?20?%}.appointment-content[data-v-292e8b16]{padding:%?20?%}}\r\n/* ç¡®ä¿è¾“å…¥æ¡†å§‹ç»ˆå¯è§ */.chat-input[data-v-292e8b16]{z-index:10000}\r\n\r\n/* H5 å¹³å°ï¼šè¾“å…¥åŒºä½¿ç”¨ sticky å¸åº•ï¼Œé¿å… fixed å¯¼è‡´åœ¨å¼¹çª—å¤–ä¸å¯è§ */.chat-content[data-v-292e8b16]{padding-bottom:%?140?%}.chat-messages[data-v-292e8b16]{padding-bottom:%?160?%}.chat-input[data-v-292e8b16]{position:-webkit-sticky;position:sticky;bottom:0;left:auto;right:auto;width:100%;padding-bottom:%?16?%}\r\n\r\n/* åŒ»ç”Ÿæ¨¡å¼ä¸‹çš„è‡ªå®šä¹‰åº•éƒ¨å¯¼èˆª */.doctor-tabbar[data-v-292e8b16]{position:fixed;left:0;right:0;bottom:0;height:%?144?%;background:#fff;border-top:%?1?% solid #eee;display:flex;align-items:center;justify-content:space-around;z-index:10001;box-sizing:border-box;overflow:hidden;padding-top:%?8?%;padding-bottom:constant(safe-area-inset-bottom);padding-bottom:env(safe-area-inset-bottom)}.doctor-tabbar-item[data-v-292e8b16]{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;color:#666}.doctor-tabbar-item .tab-icon[data-v-292e8b16]{width:%?40?%;height:%?40?%;display:block}.doctor-tabbar-item .tab-text[data-v-292e8b16]{margin-top:%?6?%;font-size:%?24?%}.doctor-tabbar-item.active[data-v-292e8b16]{color:#b49950}",""]),n.exports=t},"15ab":function(n,t,r){"use strict";var e=r("7658"),o=r("57e7");e("Map",(function(n){return function(){return n(this,arguments.length?arguments[0]:void 0)}}),o)},"15fc":function(n,t,r){"use strict";r.r(t);var e=r("6e68"),o=r("e136");for(var i in o)["default"].indexOf(i)<0&&function(n){r.d(t,n,(function(){return o[n]}))}(i);r("8fae");var a=r("828b"),s=Object(a["a"])(o["default"],e["b"],e["c"],!1,null,"292e8b16",null,!1,e["a"],void 0);t["default"]=s.exports},2634:function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
t.default=function(){return n};var n={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(n,t,r){n[t]=r.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",d=a.toStringTag||"@@toStringTag";function l(n,t,r){return Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),n[t]}try{l({},"")}catch(S){l=function(n,t,r){return n[t]=r}}function u(n,t,r,e){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new _(e||[]);return i(a,"_invoke",{value:D(n,r,s)}),a}function h(n,t,r){try{return{type:"normal",arg:n.call(t,r)}}catch(S){return{type:"throw",arg:S}}}n.wrap=u;var f={};function p(){}function m(){}function g(){}var v={};l(v,s,(function(){return this}));var b=Object.getPrototypeOf,w=b&&b(b(P([])));w&&w!==r&&o.call(w,s)&&(v=w);var y=g.prototype=p.prototype=Object.create(v);function x(n){["next","throw","return"].forEach((function(t){l(n,t,(function(n){return this._invoke(t,n)}))}))}function T(n,t){var r;i(this,"_invoke",{value:function(i,a){function s(){return new t((function(r,s){(function r(i,a,s,c){var d=h(n[i],n,a);if("throw"!==d.type){var l=d.arg,u=l.value;return u&&"object"==(0,e.default)(u)&&o.call(u,"__await")?t.resolve(u.__await).then((function(n){r("next",n,s,c)}),(function(n){r("throw",n,s,c)})):t.resolve(u).then((function(n){l.value=n,s(l)}),(function(n){return r("throw",n,s,c)}))}c(d.arg)})(i,a,r,s)}))}return r=r?r.then(s,s):s()}})}function D(n,t,r){var e="suspendedStart";return function(o,i){if("executing"===e)throw new Error("Generator is already running");if("completed"===e){if("throw"===o)throw i;return M()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var s=C(a,r);if(s){if(s===f)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===e)throw e="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);e="executing";var c=h(n,t,r);if("normal"===c.type){if(e=r.done?"completed":"suspendedYield",c.arg===f)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(e="completed",r.method="throw",r.arg=c.arg)}}}function C(n,t){var r=t.method,e=n.iterator[r];if(void 0===e)return t.delegate=null,"throw"===r&&n.iterator["return"]&&(t.method="return",t.arg=void 0,C(n,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=h(e,n.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,f;var i=o.arg;return i?i.done?(t[n.resultName]=i.value,t.next=n.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function k(n){var t={tryLoc:n[0]};1 in n&&(t.catchLoc=n[1]),2 in n&&(t.finallyLoc=n[2],t.afterLoc=n[3]),this.tryEntries.push(t)}function I(n){var t=n.completion||{};t.type="normal",delete t.arg,n.completion=t}function _(n){this.tryEntries=[{tryLoc:"root"}],n.forEach(k,this),this.reset(!0)}function P(n){if(n){var t=n[s];if(t)return t.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var r=-1,e=function t(){for(;++r<n.length;)if(o.call(n,r))return t.value=n[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return e.next=e}}return{next:M}}function M(){return{value:void 0,done:!0}}return m.prototype=g,i(y,"constructor",{value:g,configurable:!0}),i(g,"constructor",{value:m,configurable:!0}),m.displayName=l(g,d,"GeneratorFunction"),n.isGeneratorFunction=function(n){var t="function"==typeof n&&n.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},n.mark=function(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,g):(n.__proto__=g,l(n,d,"GeneratorFunction")),n.prototype=Object.create(y),n},n.awrap=function(n){return{__await:n}},x(T.prototype),l(T.prototype,c,(function(){return this})),n.AsyncIterator=T,n.async=function(t,r,e,o,i){void 0===i&&(i=Promise);var a=new T(u(t,r,e,o),i);return n.isGeneratorFunction(r)?a:a.next().then((function(n){return n.done?n.value:a.next()}))},x(y),l(y,d,"Generator"),l(y,s,(function(){return this})),l(y,"toString",(function(){return"[object Generator]"})),n.keys=function(n){var t=Object(n),r=[];for(var e in t)r.push(e);return r.reverse(),function n(){for(;r.length;){var e=r.pop();if(e in t)return n.value=e,n.done=!1,n}return n.done=!0,n}},n.values=P,_.prototype={constructor:_,reset:function(n){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(I),!n)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var n=this.tryEntries[0].completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var t=this;function r(r,e){return a.type="throw",a.arg=n,t.next=r,e&&(t.method="next",t.arg=void 0),!!e}for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=o.call(i,"catchLoc"),c=o.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(n,t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc<=this.prev&&o.call(e,"finallyLoc")&&this.prev<e.finallyLoc){var i=e;break}}i&&("break"===n||"continue"===n)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=n,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(n,t){if("throw"===n.type)throw n.arg;return"break"===n.type||"continue"===n.type?this.next=n.arg:"return"===n.type?(this.rval=this.arg=n.arg,this.method="return",this.next="end"):"normal"===n.type&&t&&(this.next=t),f},finish:function(n){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===n)return this.complete(r.completion,r.afterLoc),I(r),f}},catch:function(n){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===n){var e=r.completion;if("throw"===e.type){var o=e.arg;I(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(n,t,r){return this.delegate={iterator:P(n),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},n},r("6a54"),r("01a2"),r("e39c"),r("bf0f"),r("844d"),r("18f7"),r("de6c"),r("3872e"),r("4e9b"),r("114e"),r("c240"),r("926e"),r("7a76"),r("c9b5"),r("aa9c"),r("2797"),r("8a8d"),r("dc69"),r("f7a5");var e=function(n){return n&&n.__esModule?n:{default:n}}(r("fcf3"))},"2fdc":function(n,t,r){"use strict";function e(n,t,r,e,o,i,a){try{var s=n[i](a),c=s.value}catch(d){return void r(d)}s.done?t(c):Promise.resolve(c).then(e,o)}r("6a54"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(n){return function(){var t=this,r=arguments;return new Promise((function(o,i){var a=n.apply(t,r);function s(n){e(a,o,i,s,c,"next",n)}function c(n){e(a,o,i,s,c,"throw",n)}s(void 0)}))}},r("bf0f")},"53f7":function(n,t,r){"use strict";var e=r("7658"),o=r("57e7");e("Set",(function(n){return function(){return n(this,arguments.length?arguments[0]:void 0)}}),o)},"57e7":function(n,t,r){"use strict";var e=r("e37c"),o=r("e4ca"),i=r("a74c"),a=r("ae5c"),s=r("b720"),c=r("1eb8"),d=r("5075"),l=r("0cc2"),u=r("97ed"),h=r("437f"),f=r("ab4a"),p=r("d0b1").fastKey,m=r("235c"),g=m.set,v=m.getterFor;n.exports={getConstructor:function(n,t,r,l){var u=n((function(n,o){s(n,h),g(n,{type:t,index:e(null),first:void 0,last:void 0,size:0}),f||(n.size=0),c(o)||d(o,n[l],{that:n,AS_ENTRIES:r})})),h=u.prototype,m=v(t),b=function(n,t,r){var e,o,i=m(n),a=w(n,t);return a?a.value=r:(i.last=a={index:o=p(t,!0),key:t,value:r,previous:e=i.last,next:void 0,removed:!1},i.first||(i.first=a),e&&(e.next=a),f?i.size++:n.size++,"F"!==o&&(i.index[o]=a)),n},w=function(n,t){var r,e=m(n),o=p(t);if("F"!==o)return e.index[o];for(r=e.first;r;r=r.next)if(r.key===t)return r};return i(h,{clear:function(){var n=m(this),t=n.first;while(t)t.removed=!0,t.previous&&(t.previous=t.previous.next=void 0),t=t.next;n.first=n.last=void 0,n.index=e(null),f?n.size=0:this.size=0},delete:function(n){var t=m(this),r=w(this,n);if(r){var e=r.next,o=r.previous;delete t.index[r.index],r.removed=!0,o&&(o.next=e),e&&(e.previous=o),t.first===r&&(t.first=e),t.last===r&&(t.last=o),f?t.size--:this.size--}return!!r},forEach:function(n){var t,r=m(this),e=a(n,arguments.length>1?arguments[1]:void 0);while(t=t?t.next:r.first){e(t.value,t.key,this);while(t&&t.removed)t=t.previous}},has:function(n){return!!w(this,n)}}),i(h,r?{get:function(n){var t=w(this,n);return t&&t.value},set:function(n,t){return b(this,0===n?0:n,t)}}:{add:function(n){return b(this,n=0===n?0:n,n)}}),f&&o(h,"size",{configurable:!0,get:function(){return m(this).size}}),u},setStrong:function(n,t,r){var e=t+" Iterator",o=v(t),i=v(e);l(n,t,(function(n,t){g(this,{type:e,target:n,state:o(n),kind:t,last:void 0})}),(function(){var n=i(this),t=n.kind,r=n.last;while(r&&r.removed)r=r.previous;return n.target&&(n.last=r=r?r.next:n.state.first)?u("keys"===t?r.key:"values"===t?r.value:[r.key,r.value],!1):(n.target=void 0,u(void 0,!0))}),r?"entries":"values",!r,!0),h(t)}}},"6e68":function(n,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return i})),r.d(t,"a",(function(){return e}));var e={uniPopup:r("7bbb").default},o=function(){var n=this,t=n.$createElement,r=n._self._c||t;return r("v-uni-view",{staticClass:"content"},[r("v-uni-view",{staticClass:"box"},[n.isDoctor?n._e():r("v-uni-view",{staticClass:"search-section"},[r("v-uni-view",{staticClass:"search-box"},[r("uni-icons",{attrs:{type:"search",size:"20",color:"#999"}}),r("v-uni-input",{staticClass:"search-input",attrs:{placeholder:"æœç´¢å…½åŒ»ã€ç§‘å®¤ã€å® ç‰©ç—‡çŠ¶"},on:{input:function(t){arguments[0]=t=n.$handleEvent(t),n.onSearchInput.apply(void 0,arguments)}},model:{value:n.searchKeyword,callback:function(t){n.searchKeyword=t},expression:"searchKeyword"}})],1)],1),n.isDoctor?r("v-uni-view",{staticClass:"doctor-message-center"},[r("v-uni-view",{staticClass:"section-title"},[r("v-uni-text",[n._v("æ‚£è€…æ¶ˆæ¯")])],1),r("v-uni-view",{staticClass:"message-list"},[n._l(n.patientMessages,(function(t){return r("v-uni-view",{key:t.id,staticClass:"message-item",on:{click:function(r){arguments[0]=r=n.$handleEvent(r),n.replyToPatient(t)}}},[r("v-uni-view",{staticClass:"patient-name"},[n._v(n._s(t.patientName))]),r("v-uni-view",{staticClass:"message-preview"},[n._v(n._s(t.content))]),r("v-uni-view",{staticClass:"message-time"},[n._v(n._s(t.time))])],1)})),0===n.patientMessages.length?r("v-uni-view",{staticClass:"no-message"},[n._v("æš‚æ— æ–°æ¶ˆæ¯")]):n._e()],2)],1):n._e(),n.isDoctor?n._e():r("v-uni-view",{staticClass:"department-section"},[r("v-uni-view",{staticClass:"section-title"},[n._v("ç§‘å®¤åˆ†ç±»")]),r("v-uni-scroll-view",{staticClass:"department-scroll",attrs:{"scroll-x":"true"}},[r("v-uni-view",{staticClass:"department-list"},n._l(n.departmentList,(function(t){return r("v-uni-view",{key:t.id,staticClass:"department-item",class:{active:n.selectedDepartment===t.id},on:{click:function(r){arguments[0]=r=n.$handleEvent(r),n.selectDepartment(t.id)}}},[r("v-uni-view",{staticClass:"department-icon"},[n._v(n._s(t.icon))]),r("v-uni-view",{staticClass:"department-name"},[n._v(n._s(t.name))])],1)})),1)],1)],1),n.isDoctor?n._e():r("v-uni-view",{staticClass:"doctor-section"},[r("v-uni-view",{staticClass:"section-title"},[n._v("æ¨èåŒ»ç”Ÿ")]),r("v-uni-view",{staticClass:"doctor-list"},n._l(n.filteredDoctorList,(function(t){return r("v-uni-view",{key:t.id,staticClass:"doctor-item",on:{click:function(r){arguments[0]=r=n.$handleEvent(r),n.onDoctorTap(t)}}},[r("v-uni-view",{staticClass:"doctor-avatar"},[t.avatarUrl?r("v-uni-image",{staticClass:"doctor-avatar-img",attrs:{src:t.avatarUrl,mode:"cover"}}):r("v-uni-view",{staticClass:"doctor-avatar-fallback"},[n._v("ğŸ‘©â€âš•ï¸")])],1),r("v-uni-view",{staticClass:"doctor-info"},[r("v-uni-view",{staticClass:"doctor-name"},[n._v(n._s(t.name)),1===t.online?r("v-uni-view",{staticClass:"online-status"},[n._v("åœ¨çº¿")]):r("v-uni-view",{staticClass:"offline-status"},[n._v("ç¦»çº¿")])],1),r("v-uni-view",{staticClass:"doctor-title"},[n._v(n._s(t.title))]),r("v-uni-view",{staticClass:"doctor-department"},[n._v(n._s(t.department))]),r("v-uni-view",{staticClass:"doctor-specialty"},[n._v(n._s(t.specialty))]),r("v-uni-view",{staticClass:"doctor-rating"},[r("uni-rate",{attrs:{value:t.rating,size:"16",readonly:!0}}),r("v-uni-text",{staticClass:"rating-text"},[n._v(n._s(t.rating)+"åˆ†")])],1)],1),r("v-uni-view",{staticClass:"doctor-actions"},[r("v-uni-button",{staticClass:"action-btn chat-btn",on:{click:function(r){r.stopPropagation(),arguments[0]=r=n.$handleEvent(r),n.startChat(t)}}},[n._v("åœ¨çº¿é—®è¯Š")]),r("v-uni-button",{staticClass:"action-btn appointment-btn",on:{click:function(r){r.stopPropagation(),arguments[0]=r=n.$handleEvent(r),n.makeAppointment(t)}}},[n._v("é¢„çº¦æŒ‚å·")])],1)],1)})),1)],1)],1),r("uni-popup",{ref:"chatPopup",attrs:{type:"bottom","mask-click":!1,"z-index":10080}},[r("v-uni-view",{staticClass:"chat-popup"},[r("v-uni-view",{staticClass:"chat-header"},[n.isDoctor?r("v-uni-view",{staticClass:"chat-title"},[n._v("ä¸"+n._s(n.currentPatient.patientName)+"çš„å¯¹è¯")]):r("v-uni-view",{staticClass:"chat-title"},[n._v("å® ç‰©åœ¨çº¿é—®è¯Š - "+n._s(n.currentDoctor.name))]),r("v-uni-view",{staticClass:"chat-actions"},[r("v-uni-button",{staticClass:"clear-btn",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.onClearChatTap.apply(void 0,arguments)}}},[n._v("æ¸…ç©ºè®°å½•")]),r("v-uni-view",{staticClass:"chat-close",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.closeChat.apply(void 0,arguments)}}},[n._v("Ã—")])],1)],1),r("v-uni-view",{staticClass:"chat-content"},[r("v-uni-scroll-view",{staticClass:"chat-messages",attrs:{"scroll-y":"true","scroll-top":n.scrollTop,"scroll-with-animation":"true"}},n._l(n.chatMessages,(function(t){return r("v-uni-view",{key:t.id,staticClass:"message-item",class:(n.isDoctor?"doctor"===t.senderType:"user"===t.senderType)?"message-right":"message-left"},[t.content?r("v-uni-view",{staticClass:"message-content"},[n._v(n._s(t.content))]):n._e(),t.imageUrl?r("v-uni-image",{staticClass:"message-image",attrs:{src:n.baseUrl+"/upload/"+t.imageUrl,mode:"widthFix"},on:{click:function(r){arguments[0]=r=n.$handleEvent(r),n.previewImage(n.baseUrl+"/upload/"+t.imageUrl)}}}):n._e(),r("v-uni-view",{staticClass:"message-time"},[n._v(n._s(t.time))])],1)})),1),r("v-uni-view",{staticClass:"chat-input"},[n.isDoctor?n._e():r("uni-icons",{staticStyle:{margin:"0 10rpx"},attrs:{type:"image",size:"28",color:"#333"},on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.chooseImage.apply(void 0,arguments)}}}),r("v-uni-input",{staticClass:"input-field",attrs:{placeholder:"è¯·æè¿°å® ç‰©çš„ç—‡çŠ¶æˆ–é—®é¢˜...","adjust-position":!0,"cursor-spacing":20},on:{confirm:function(t){arguments[0]=t=n.$handleEvent(t),n.sendMessage.apply(void 0,arguments)}},model:{value:n.inputMessage,callback:function(t){n.inputMessage=t},expression:"inputMessage"}}),r("v-uni-button",{staticClass:"send-btn",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.sendMessage.apply(void 0,arguments)}}},[n._v("å‘é€")])],1)],1)],1)],1),r("uni-popup",{ref:"appointmentPopup",attrs:{type:"bottom","mask-click":!1,"z-index":10080}},[r("v-uni-view",{staticClass:"appointment-popup"},[r("v-uni-view",{staticClass:"appointment-header"},[r("v-uni-view",{staticClass:"appointment-title"},[n._v("é¢„çº¦æŒ‚å·")]),r("v-uni-view",{staticClass:"appointment-close",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.closeAppointment.apply(void 0,arguments)}}},[n._v("Ã—")])],1),r("v-uni-view",{staticClass:"appointment-content"},[r("v-uni-view",{staticClass:"form-item"},[r("v-uni-view",{staticClass:"form-label"},[n._v("é€‰æ‹©æ—¥æœŸ")]),r("v-uni-picker",{attrs:{mode:"date",value:n.appointmentDate},on:{change:function(t){arguments[0]=t=n.$handleEvent(t),n.onDateChange.apply(void 0,arguments)}}},[r("v-uni-view",{staticClass:"picker-value"},[n._v(n._s(n.appointmentDate||"è¯·é€‰æ‹©æ—¥æœŸ"))])],1)],1),r("v-uni-view",{staticClass:"form-item"},[r("v-uni-view",{staticClass:"form-label"},[n._v("é€‰æ‹©æ—¶é—´")]),r("v-uni-picker",{attrs:{mode:"selector",range:n.timeSlots,value:n.timeIndex},on:{change:function(t){arguments[0]=t=n.$handleEvent(t),n.onTimeChange.apply(void 0,arguments)}}},[r("v-uni-view",{staticClass:"picker-value"},[n._v(n._s(n.timeSlots[n.timeIndex]||"è¯·é€‰æ‹©æ—¶é—´"))])],1)],1),r("v-uni-view",{staticClass:"form-item"},[r("v-uni-view",{staticClass:"form-label"},[n._v("å® ç‰©ç—‡çŠ¶æè¿°")]),r("v-uni-textarea",{staticClass:"symptom-input",attrs:{placeholder:"è¯·æè¿°å® ç‰©çš„ç—‡çŠ¶ã€è¡Œä¸ºå¼‚å¸¸æˆ–ä¸é€‚...",maxlength:"200","adjust-position":!0,"cursor-spacing":20},model:{value:n.symptomDescription,callback:function(t){n.symptomDescription=t},expression:"symptomDescription"}})],1),r("v-uni-button",{staticClass:"submit-btn",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.submitAppointment.apply(void 0,arguments)}}},[n._v("ç¡®è®¤é¢„çº¦")])],1)],1)],1),n.isDoctor&&!n.isChatOpen?r("v-uni-view",{staticClass:"doctor-tabbar"},[r("v-uni-view",{staticClass:"doctor-tabbar-item active",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.switchTo("medical")}}},[r("v-uni-image",{staticClass:"tab-icon",attrs:{src:"/static/tabs/service_act.png"}}),r("v-uni-text",{staticClass:"tab-text"},[n._v("é—®è¯Š")])],1),r("v-uni-view",{staticClass:"doctor-tabbar-item",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.switchTo("center")}}},[r("v-uni-image",{staticClass:"tab-icon",attrs:{src:"/static/tabs/mine.png"}}),r("v-uni-text",{staticClass:"tab-text"},[n._v("æˆ‘çš„")])],1)],1):n._e()],1)},i=[]},"73e1":function(n,t,r){"use strict";var e=r("29d8");n.exports=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(e)},"795c":function(n,t,r){"use strict";var e=r("8bdb"),o=r("db04").start,i=r("73e1");e({target:"String",proto:!0,forced:i},{padStart:function(n){return o(this,n,arguments.length>1?arguments[1]:void 0)}})},"8db1":function(n,t,r){var e=r("10eb");e.__esModule&&(e=e.default),"string"===typeof e&&(e=[[n.i,e,""]]),e.locals&&(n.exports=e.locals);var o=r("967d").default;o("fb29d866",e,!0,{sourceMap:!1,shadowMode:!1})},"8fae":function(n,t,r){"use strict";var e=r("8db1"),o=r.n(e);o.a},c1a3:function(n,t,r){"use strict";r("15ab")},d71d:function(n,t,r){"use strict";r("6a54");var e=r("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=e(r("9b1b")),i=e(r("2634")),a=e(r("2fdc"));r("8f71"),r("bf0f"),r("4626"),r("5ac7"),r("c223"),r("5c47"),r("0506"),r("a1c1"),r("9db6"),r("fd3c"),r("64aa"),r("c1a3"),r("18f7"),r("de6c"),r("2797"),r("08eb"),r("aa9c"),r("f3f7"),r("4100"),r("0c26"),r("e062"),r("795c"),r("c9b5"),r("ab80");var s={data:function(){return{searchKeyword:"",selectedDepartment:"all",currentDoctor:{},inputMessage:"",chatMessages:[],baseUrl:"",scrollTop:0,appointmentDate:"",timeIndex:0,symptomDescription:"",departmentList:[{id:"all",name:"å…¨éƒ¨ç§‘å®¤",icon:"ğŸ¥"},{id:"internal",name:"å†…ç§‘",icon:"ğŸ«€"},{id:"surgery",name:"å¤–ç§‘",icon:"ğŸ”ª"},{id:"dermatology",name:"çš®è‚¤ç§‘",icon:"ğŸ¦ "},{id:"ophthalmology",name:"çœ¼ç§‘",icon:"ğŸ‘ï¸"},{id:"dental",name:"å£è…”ç§‘",icon:"ğŸ¦·"},{id:"emergency",name:"æ€¥è¯Šç§‘",icon:"ğŸš‘"},{id:"vaccine",name:"ç–«è‹—ç§‘",icon:"ğŸ’‰"}],doctorList:[],timeSlots:["09:00","09:30","10:00","10:30","11:00","14:00","14:30","15:00","15:30","16:00"],isDoctor:!1,doctorInfo:{},patientMessages:[],currentPatient:{},doctorPollingTimer:null,userPollingTimer:null,chatPollingTimer:null,isChatOpen:!1,doctorListPollingTimer:null,doctorReady:!1}},onLoad:function(){this.baseUrl=this.$api.baseUrl,console.log("å½“å‰ baseUrl:",this.baseUrl);try{var n=uni.getStorageSync("nowTable");if("doctor"===n){this.isDoctor=!0;try{uni.hideTabBar()}catch(t){}}}catch(t){}this.checkUserType(),this.loadDoctorList()},onShow:function(){if(this.isDoctor)try{uni.hideTabBar()}catch(n){}else try{uni.showTabBar()}catch(n){}this.isDoctor&&this.doctorInfo&&this.doctorInfo.id?(this.checkNewMessages(),this.doctorPollingTimer||this.startDoctorPolling()):this.doctorListPollingTimer||this.startDoctorListPolling()},onHide:function(){this.stopDoctorPolling(),this.stopUserPolling(),this.stopDoctorChatPolling(),this.stopDoctorListPolling()},onUnload:function(){this.stopDoctorPolling(),this.stopUserPolling()},computed:{filteredDoctorList:function(){var n=this,t=this.doctorList;return"all"!==this.selectedDepartment&&(t=t.filter((function(t){return t.departmentId===n.selectedDepartment}))),this.searchKeyword&&(t=t.filter((function(t){return t.name.includes(n.searchKeyword)||t.department.includes(n.searchKeyword)}))),t}},methods:{switchTo:function(n){"medical"!==n&&"center"===n&&uni.switchTab({url:"/pages/center/center"})},onClearChatTap:function(){var n=this;return(0,a.default)((0,i.default)().mark((function t(){return(0,i.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n.isChatOpen){t.next=2;break}return t.abrupt("return");case 2:uni.showModal({title:"æ¸…ç©ºèŠå¤©è®°å½•",content:"ç¡®å®šè¦æ¸…ç©ºå½“å‰ä¼šè¯çš„æ‰€æœ‰èŠå¤©è®°å½•å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚",success:function(){var t=(0,a.default)((0,i.default)().mark((function t(r){return(0,i.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!r.confirm){t.next=3;break}return t.next=3,n.clearChatHistory();case 3:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}()});case 3:case"end":return t.stop()}}),t)})))()},clearChatHistory:function(){var n=this;return(0,a.default)((0,i.default)().mark((function t(){var r,e;return(0,i.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!n.isDoctor){t.next=9;break}if(n.doctorInfo&&n.doctorInfo.id&&n.currentPatient&&n.currentPatient.userId){t.next=5;break}return uni.showToast({title:"åŒ»ç”Ÿæˆ–æ‚£è€…ä¿¡æ¯ä¸å®Œæ•´",icon:"none"}),t.abrupt("return");case 5:e=n.doctorInfo.id,r=n.currentPatient.userId,t.next=14;break;case 9:if(r=uni.getStorageSync("userid"),e=n.currentDoctor&&n.currentDoctor.id,r&&e){t.next=14;break}return uni.showToast({title:"ç”¨æˆ·æˆ–åŒ»ç”Ÿä¿¡æ¯ä¸å®Œæ•´",icon:"none"}),t.abrupt("return");case 14:return n.stopUserPolling(),n.stopDoctorChatPolling(),uni.showLoading({title:"æ¸…ç†ä¸­..."}),t.next=19,n.$api.post("message/clearConversation?userId=".concat(r,"&doctorId=").concat(e),{});case 19:uni.hideLoading(),n.chatMessages=[],n.scrollToBottom(),uni.showToast({title:"å·²æ¸…ç©º",icon:"success"}),n.isChatOpen&&(n.isDoctor?n.startDoctorChatPolling():n.startUserPolling()),t.next=31;break;case 26:t.prev=26,t.t0=t["catch"](0),uni.hideLoading(),console.error("æ¸…ç©ºèŠå¤©è®°å½•å¤±è´¥",t.t0),uni.showToast({title:"æ¸…ç©ºå¤±è´¥ï¼Œè¯·ç¨åå†è¯•",icon:"none"});case 31:case"end":return t.stop()}}),t,null,[[0,26]])})))()},normalizeImage:function(n){if(!n)return"";if(/^https?:\/\//i.test(n))return n;var t=String(n).replace(/^\/+/,"");return t.startsWith("upload/")?"".concat(this.baseUrl,"/").concat(t):"".concat(this.baseUrl,"/upload/").concat(t)},chooseImage:function(){var n=this;uni.chooseImage({count:1,sizeType:["compressed"],sourceType:["album","camera"],success:function(t){var r=t.tempFilePaths[0],e=n.baseUrl+"/file/upload";uni.showLoading({title:"ä¸Šä¼ ä¸­..."}),uni.uploadFile({url:e,filePath:r,name:"file",header:{Token:uni.getStorageSync("token")},success:function(t){uni.hideLoading();var r=JSON.parse(t.data);0===r.code?n.sendAsMessage({imageUrl:r.file}):uni.showToast({title:r.msg||"ä¸Šä¼ å¤±è´¥",icon:"none"})},fail:function(n){uni.hideLoading(),uni.showToast({title:"ä¸Šä¼ å¤±è´¥",icon:"none"})}})}})},previewImage:function(n){uni.previewImage({urls:[n]})},onSearchInput:function(){},checkUserType:function(){var n=this,t=uni.getStorageSync("nowTable")||"defaultuser",r=uni.getStorageSync("userid");r?this.$api.session(t).then((function(r){if(console.log("ç”¨æˆ·ä¿¡æ¯å“åº”:",r),r&&r.data){var e=r.data,o="doctor"===t;if(n.isDoctor=o,n.isDoctor){try{uni.hideTabBar()}catch(s){}n.doctorInfo=e,n.doctorReady=!0,uni.setStorageSync("doctorInfo",e);try{var i=uni.getStorageSync("lastDoctorId");i&&i!==n.doctorInfo.id&&n.$api.post("doctor/updateOnlineStatus?id=".concat(i,"&online=0"),{})}catch(s){}uni.setStorageSync("lastDoctorId",n.doctorInfo.id),console.log("åŒ»ç”Ÿä¿¡æ¯å·²è®¾ç½®å¹¶å­˜å‚¨:",n.doctorInfo),n.checkNewMessages(),n.startDoctorPolling()}else{try{uni.showTabBar()}catch(s){}console.log("éåŒ»ç”Ÿç”¨æˆ·:",e),uni.removeStorageSync("doctorInfo"),n.doctorReady=!1;try{var a=uni.getStorageSync("lastDoctorId");a&&(n.$api.post("doctor/updateOnlineStatus?id=".concat(a,"&online=0"),{}),uni.removeStorageSync("lastDoctorId"))}catch(s){}}}else n.isDoctor=!1,n.doctorInfo={},n.doctorReady=!1,console.error("æœªè·å–åˆ°ç”¨æˆ·ä¿¡æ¯"),uni.removeStorageSync("doctorInfo")})).catch((function(t){console.error("è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥",t),n.isDoctor=!1,n.doctorInfo={},n.doctorReady=!1,uni.removeStorageSync("doctorInfo")})):(this.isDoctor=!1,this.doctorInfo={},this.doctorReady=!1,console.error("ç”¨æˆ·æœªç™»å½•"),uni.removeStorageSync("doctorInfo"))},loadDoctorList:function(){var n=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t&&uni.showLoading({title:"åŠ è½½ä¸­..."}),this.$api.page("doctor",{}).then((function(r){t&&uni.hideLoading(),r&&0===r.code&&r.data&&r.data.list?n.doctorList=r.data.list.map((function(t){return{id:t.id,name:t.doctorxingming,title:t.zhicheng,department:t.keshi,avatar:t.touxiang||"",avatarUrl:n.normalizeImage(t.touxiang),account:t.doctorzhanghao||"",rating:t.pingfen||5,departmentId:n.getDepartmentId(t.keshi),specialty:"æ“…é•¿ï¼š".concat(t.zhuanchang||"å® ç‰©ç–¾ç—…è¯Šç–—"),online:1===Number(t.online)?1:0}})):uni.showToast({title:r.msg||"åŠ è½½åŒ»ç”Ÿåˆ—è¡¨å¤±è´¥",icon:"none"})})).catch((function(n){t&&uni.hideLoading(),console.error("åŠ è½½åŒ»ç”Ÿåˆ—è¡¨å¤±è´¥",n);var r="åŠ è½½å¤±è´¥ï¼Œè¯·ç¨åå†è¯•";n&&n.errMsg?r+=" (".concat(n.errMsg,")"):n&&n.message&&(r+=" (".concat(n.message,")")),uni.showToast({title:r,icon:"none"})}))},startDoctorListPolling:function(){var n=this;this.doctorListPollingTimer||(this.doctorListPollingTimer=setInterval((function(){n.isDoctor||n.loadDoctorList(!1)}),2e4))},stopDoctorListPolling:function(){this.doctorListPollingTimer&&(clearInterval(this.doctorListPollingTimer),this.doctorListPollingTimer=null)},getDepartmentId:function(n){return{"å†…ç§‘":"internal","å¤–ç§‘":"surgery","çš®è‚¤ç§‘":"dermatology","çœ¼ç§‘":"ophthalmology","å£è…”ç§‘":"dental","æ€¥è¯Šç§‘":"emergency","ç–«è‹—ç§‘":"vaccine"}[n]||"all"},checkNewMessages:function(){var n=this,t=uni.getStorageSync("doctorInfo");if(t&&!this.doctorInfo.id&&(this.doctorInfo=t,this.isDoctor=!0,console.log("ä»æœ¬åœ°å­˜å‚¨æ¢å¤åŒ»ç”Ÿä¿¡æ¯:",this.doctorInfo)),!this.isDoctor||!this.doctorInfo.id)return console.error("ä¸æ˜¯åŒ»ç”Ÿæˆ–åŒ»ç”Ÿä¿¡æ¯ä¸å®Œæ•´ï¼Œæ— æ³•åŠ è½½æ‚£è€…æ¶ˆæ¯"),void(this.doctorReady&&uni.showToast({title:"åŒ»ç”Ÿèº«ä»½éªŒè¯å¤±è´¥ï¼Œè¯·é‡æ–°ç™»å½•",icon:"none"}));this.$api.list("message",{type:"unread",doctorId:this.doctorInfo.id}).then((function(t){if(console.log("æ¶ˆæ¯åˆ—è¡¨å“åº”:",t),t&&0===t.code&&t.data){var r=t.data.filter((function(n){return"user"===n.senderType})).map((function(t){return{id:t.id,patientName:t.userName||"æœªçŸ¥æ‚£è€…",content:t.content||"",time:n.formatTime(new Date(t.sendTime||Date.now())),userId:t.userId,senderType:t.senderType,sendTime:t.sendTime||Date.now()}})),e=new Map;r.forEach((function(n){(!e.has(n.userId)||new Date(n.sendTime)>new Date(e.get(n.userId).sendTime))&&e.set(n.userId,n)}));var i=Array.from(e.values()),a=new Map(n.patientMessages.map((function(n,t){return[n.userId,{idx:t,item:n}]}))),s=!1;i.forEach((function(t){var r=a.get(t.userId);if(r){var e=r.item;e.id===t.id&&e.content===t.content&&e.sendTime===t.sendTime||(e.id=t.id,e.patientName=t.patientName,e.content=t.content,e.time=t.time,e.senderType=t.senderType,e.sendTime=t.sendTime,s=!0)}else n.patientMessages.push((0,o.default)({},t)),s=!0}));var c=new Set(i.map((function(n){return n.userId}))),d=n.patientMessages.length;n.patientMessages=n.patientMessages.filter((function(n){return c.has(n.userId)})),n.patientMessages.length!==d&&(s=!0),s&&(n.patientMessages.sort((function(n,t){return new Date(t.sendTime)-new Date(n.sendTime)})),console.log("åŠ è½½æ‚£è€…æ¶ˆæ¯æˆåŠŸï¼Œå…±",n.patientMessages.length,"æ¡(å·²å»é‡/å¢é‡æ›´æ–°)"),uni.vibrateShort())}else console.error("åŠ è½½æ¶ˆæ¯å¤±è´¥:",t),uni.showToast({title:t.msg||"åŠ è½½æ¶ˆæ¯å¤±è´¥",icon:"none"})})).catch((function(n){console.error("åŠ è½½æ¶ˆæ¯å¤±è´¥",n),uni.showToast({title:"ç½‘ç»œé”™è¯¯ï¼Œè¯·æ£€æŸ¥ç½‘ç»œåé‡è¯•",icon:"none"})}))},selectDepartment:function(n){this.selectedDepartment=n},onDoctorTap:function(n){uni.showToast({title:"æŸ¥çœ‹".concat(n.name,"å…½åŒ»è¯¦æƒ…"),icon:"none"})},replyToPatient:function(n){var t=this;this.stopDoctorChatPolling(),this.currentPatient=n,uni.showLoading({title:"åŠ è½½èŠå¤©è®°å½•ä¸­..."}),this.$api.list("message",{doctorId:this.doctorInfo.id,userId:n.userId}).then((function(n){uni.hideLoading(),n&&0===n.code&&n.data?(t.chatMessages=n.data.map((function(n){return{id:n.id,content:n.content,imageUrl:n.imageUrl,time:t.formatTime(new Date(n.sendTime)),ts:n.sendTime?new Date(n.sendTime).getTime():n.id||0,senderType:"doctor"===n.senderType?"doctor":"user"}})),t.chatMessages.sort((function(n,t){return(n.ts||0)-(t.ts||0)})),t.currentDoctor={id:t.doctorInfo.id,name:t.doctorInfo.doctorxingming},t.$refs.chatPopup.open(),t.isChatOpen=!0,t.$nextTick((function(){setTimeout((function(){t.scrollToBottom()}),500)})),t.startDoctorChatPolling()):uni.showToast({title:n.msg||"åŠ è½½èŠå¤©è®°å½•å¤±è´¥",icon:"none"})})).catch((function(n){uni.hideLoading(),console.error("åŠ è½½èŠå¤©è®°å½•å¤±è´¥",n),uni.showToast({title:"åŠ è½½èŠå¤©è®°å½•å¤±è´¥ï¼Œè¯·ç¨åå†è¯•",icon:"none"})}))},startChat:function(n){var t=this;if(this.currentDoctor=n,this.chatMessages=[],this.isDoctor)this.chatMessages=[{id:Date.now(),content:"æ‚¨å¥½ï¼Œæˆ‘æ˜¯".concat(n.name,"å…½åŒ»ï¼Œè¯·é—®æ‚¨çš„å® ç‰©æœ‰ä»€ä¹ˆé—®é¢˜éœ€è¦å¸®åŠ©å—ï¼Ÿ"),time:this.formatTime(new Date),ts:Date.now(),senderType:"doctor"}],this.$refs.chatPopup.open(),this.$nextTick((function(){setTimeout((function(){t.scrollToBottom()}),500)}));else{uni.showLoading({title:"åŠ è½½èŠå¤©è®°å½•ä¸­..."});var r=uni.getStorageSync("userid");this.$api.list("message",{userId:r,doctorId:n.id}).then((function(r){uni.hideLoading(),r&&0===r.code&&r.data?(t.chatMessages=r.data.map((function(n){return{id:n.id,content:n.content,imageUrl:n.imageUrl,time:t.formatTime(new Date(n.sendTime)),ts:n.sendTime?new Date(n.sendTime).getTime():n.id||0,senderType:"doctor"===n.senderType?"doctor":"user"}})),t.chatMessages.sort((function(n,t){return(n.ts||0)-(t.ts||0)})),0===t.chatMessages.length&&t.chatMessages.push({id:Date.now()+Math.floor(1e3*Math.random()),content:"æ‚¨å¥½ï¼Œæˆ‘æ˜¯".concat(n.name,"å…½åŒ»ï¼Œè¯·é—®æ‚¨çš„å® ç‰©æœ‰ä»€ä¹ˆé—®é¢˜éœ€è¦å¸®åŠ©å—ï¼Ÿ"),time:t.formatTime(new Date),ts:Date.now(),senderType:"doctor"})):(t.chatMessages.push({id:Date.now()+Math.floor(1e3*Math.random()),content:"æ‚¨å¥½ï¼Œæˆ‘æ˜¯".concat(n.name,"å…½åŒ»ï¼Œè¯·é—®æ‚¨çš„å® ç‰©æœ‰ä»€ä¹ˆé—®é¢˜éœ€è¦å¸®åŠ©å—ï¼Ÿ"),time:t.formatTime(new Date),ts:Date.now(),senderType:"doctor"}),uni.showToast({title:r.msg||"åŠ è½½èŠå¤©è®°å½•å¤±è´¥",icon:"none"})),t.$refs.chatPopup.open(),t.isChatOpen=!0,t.startUserPolling(),t.$nextTick((function(){setTimeout((function(){t.scrollToBottom()}),500)}))})).catch((function(r){uni.hideLoading(),console.error("åŠ è½½èŠå¤©è®°å½•å¤±è´¥",r),t.chatMessages.push({id:Date.now()+Math.floor(1e3*Math.random()),content:"æ‚¨å¥½ï¼Œæˆ‘æ˜¯".concat(n.name,"å…½åŒ»ï¼Œè¯·é—®æ‚¨çš„å® ç‰©æœ‰ä»€ä¹ˆé—®é¢˜éœ€è¦å¸®åŠ©å—ï¼Ÿ"),time:t.formatTime(new Date),ts:Date.now(),senderType:"doctor"}),uni.showToast({title:"åŠ è½½èŠå¤©è®°å½•å¤±è´¥ï¼Œè¯·ç¨åå†è¯•",icon:"none"}),t.$refs.chatPopup.open(),t.isChatOpen=!0,t.startUserPolling(),t.$nextTick((function(){setTimeout((function(){t.scrollToBottom()}),500)}))}))}},closeChat:function(){this.$refs.chatPopup.close(),this.inputMessage="",this.isChatOpen=!1,this.stopUserPolling(),this.stopDoctorChatPolling()},sendMessage:function(){this.inputMessage.trim()?this.sendAsMessage({content:this.inputMessage}):uni.showToast({title:"è¯·è¾“å…¥æ¶ˆæ¯å†…å®¹",icon:"none"})},sendAsMessage:function(n){var t=this,r=n.content,e=n.imageUrl;if(r||e){var o={id:Date.now()+Math.floor(1e3*Math.random()),content:r,imageUrl:e,time:this.formatTime(new Date),ts:Date.now(),senderType:this.isDoctor?"doctor":"user"};this.chatMessages.push(o),this.chatMessages.sort((function(n,t){return(n.ts||0)-(t.ts||0)})),this.scrollToBottom(),this.inputMessage="",this.isDoctor?this.executeSendMessage(r,e):this.$api.info("doctor",this.currentDoctor.id).then((function(n){0===n.code&&n.data&&1!==Number(n.data.online)?uni.showModal({title:"æç¤º",content:"å½“å‰åŒ»ç”Ÿä¸åœ¨çº¿ï¼Œæ‚¨çš„æ¶ˆæ¯å°†è½¬ä¸ºç•™è¨€ï¼ŒåŒ»ç”Ÿä¸Šçº¿åä¼šå°½å¿«å›å¤æ‚¨ã€‚",showCancel:!1,success:function(){t.executeSendMessage(r,e)}}):t.executeSendMessage(r,e)})).catch((function(n){console.error("æ£€æŸ¥åŒ»ç”ŸçŠ¶æ€å¤±è´¥",n),t.executeSendMessage(r,e)}))}},executeSendMessage:function(n,t){var r,e=this;if(uni.showLoading({title:"å‘é€ä¸­..."}),this.isDoctor){if(!this.doctorInfo||!this.doctorInfo.id||!this.currentPatient||!this.currentPatient.userId)return uni.hideLoading(),void uni.showToast({title:"åŒ»ç”Ÿæˆ–æ‚£è€…ä¿¡æ¯ä¸å®Œæ•´",icon:"none"});var o="userId=".concat(this.currentPatient.userId,"&username=").concat(this.currentPatient.patientName,"&doctorId=").concat(this.doctorInfo.id);n&&(o+="&content=".concat(encodeURIComponent(n))),t&&(o+="&imageUrl=".concat(encodeURIComponent(t))),r=this.$api.post("message/reply?".concat(o),{role:"doctor",doctorId:this.doctorInfo.id})}else{var i="doctorId=".concat(this.currentDoctor.id);n&&(i+="&content=".concat(encodeURIComponent(n))),t&&(i+="&imageUrl=".concat(encodeURIComponent(t))),r=this.$api.post("message/send?".concat(i),{})}r.then((function(n){uni.hideLoading(),0===n.code?e.isDoctor||e.startUserPolling():uni.showToast({title:n.msg||"å‘é€å¤±è´¥",icon:"none"})})).catch((function(n){uni.hideLoading(),console.error("å‘é€æ¶ˆæ¯å¤±è´¥",n),uni.showToast({title:"å‘é€å¤±è´¥ï¼Œè¯·ç¨åå†è¯•",icon:"none"})}))},checkDoctorReply:function(){var n=this;this.currentDoctor&&this.currentDoctor.id&&this.$api.list("message",{userId:uni.getStorageSync("userid"),doctorId:this.currentDoctor.id}).then((function(t){var r=t&&t.data||[];if(Array.isArray(r)&&r.length>0){var e=new Set(n.chatMessages.map((function(n){return n.id}))),o=!1;r.forEach((function(t){"doctor"!==t.senderType||e.has(t.id)||(n.chatMessages.push({id:t.id,content:t.content,imageUrl:t.imageUrl,time:n.formatTime(new Date(t.sendTime)),ts:t.sendTime?new Date(t.sendTime).getTime():t.id||0,senderType:"doctor"}),o=!0)})),o&&(n.chatMessages.sort((function(n,t){return(n.ts||0)-(t.ts||0)})),n.scrollToBottom(),uni.vibrateShort())}})).catch((function(n){console.error("è·å–åŒ»ç”Ÿå›å¤å¤±è´¥",n)}))},startUserPolling:function(){var n=this;this.userPollingTimer||(this.userPollingTimer=setInterval((function(){n.isChatOpen&&n.checkDoctorReply()}),5e3))},stopUserPolling:function(){this.userPollingTimer&&(clearInterval(this.userPollingTimer),this.userPollingTimer=null)},startDoctorPolling:function(){var n=this;this.doctorPollingTimer||(this.doctorPollingTimer=setInterval((function(){n.checkNewMessages()}),5e3))},stopDoctorPolling:function(){this.doctorPollingTimer&&(clearInterval(this.doctorPollingTimer),this.doctorPollingTimer=null)},startDoctorChatPolling:function(){var n=this;if(!this.isDoctor||!this.chatPollingTimer){if(!this.currentPatient||!this.currentPatient.userId||!this.doctorInfo.id)return;this.chatPollingTimer=setInterval((function(){n.isChatOpen&&n.pollDoctorChatMessages()}),3e3)}},stopDoctorChatPolling:function(){this.chatPollingTimer&&(clearInterval(this.chatPollingTimer),this.chatPollingTimer=null,console.log("åŒ»ç”ŸèŠå¤©çª—å£è½®è¯¢å·²åœæ­¢"))},pollDoctorChatMessages:function(){var n=this;this.isDoctor&&this.currentPatient&&this.currentPatient.userId&&this.doctorInfo.id&&this.$api.list("message",{doctorId:this.doctorInfo.id,userId:this.currentPatient.userId}).then((function(t){if(t&&0===t.code&&Array.isArray(t.data)){var r=t.data.map((function(t){return{id:t.id,content:t.content,imageUrl:t.imageUrl,time:n.formatTime(new Date(t.sendTime)),ts:t.sendTime?new Date(t.sendTime).getTime():t.id||0,senderType:"doctor"===t.senderType?"doctor":"user"}})),e=new Set(n.chatMessages.map((function(n){return n.id}))),o=!1;r.forEach((function(t){e.has(t.id)||(n.chatMessages.push(t),o=!0)})),o&&(n.chatMessages.sort((function(n,t){return(n.ts||0)-(t.ts||0)})),n.scrollToBottom(),uni.vibrateShort())}})).catch((function(n){console.error("è½®è¯¢åŒ»ç”ŸèŠå¤©æ¶ˆæ¯å¤±è´¥",n)}))},scrollToBottom:function(){var n=this;this.$nextTick((function(){var t=uni.createSelectorQuery().in(n);t.select(".chat-messages").boundingClientRect(),t.selectViewport().scrollOffset(),t.exec((function(t){t&&t[0]?n.scrollTop=t[0].height:n.scrollTop=Number.MAX_SAFE_INTEGER}))}))},makeAppointment:function(n){this.currentDoctor=n,this.appointmentDate="",this.timeIndex=0,this.symptomDescription="",this.$refs.appointmentPopup.open()},closeAppointment:function(){this.$refs.appointmentPopup.close()},onDateChange:function(n){this.appointmentDate=n.detail.value},onTimeChange:function(n){this.timeIndex=n.detail.value},submitAppointment:function(){var n=this;if(this.appointmentDate)if(this.symptomDescription.trim()){uni.showLoading({title:"æäº¤ä¸­..."});var t=uni.getStorageSync("userid");if(!t)return uni.hideLoading(),uni.showToast({title:"è¯·å…ˆç™»å½•",icon:"none"}),void uni.navigateTo({url:"/pages/login/login"});var r=uni.getStorageSync("nowTable")||"defaultuser";this.$api.session(r).then((function(r){var e=r&&r.data||{},o=n.timeSlots[n.timeIndex]||"",i="".concat(n.appointmentDate," ").concat(o,":00"),a={yuyuebianhao:Date.now(),xiangmumingcheng:"".concat(n.currentDoctor.name||"","ï¼ˆåŒ»ç”Ÿé¢„çº¦ï¼‰"),fengmian:"",yuyueshijian:i,yuyueshizhang:"30åˆ†é’Ÿ",beizhu:n.symptomDescription.trim(),zhanghao:e.zhanghao||"",xingming:e.xingming||"",shouji:e.shouji||"",shangjiazhanghao:n.currentDoctor.account||"",dianpuming:n.currentDoctor.name||"",sfsh:"å¾…å®¡æ ¸",shhf:"",userid:t||e.id||""};n.$api.add("xiangmuyuyue",a).then((function(t){uni.hideLoading(),t&&0===t.code?(uni.showToast({title:"å® ç‰©é¢„çº¦æˆåŠŸï¼",icon:"success"}),n.closeAppointment()):uni.showToast({title:t.msg||"é¢„çº¦å¤±è´¥",icon:"none"})})).catch((function(n){uni.hideLoading(),uni.showToast({title:"æäº¤å¤±è´¥ï¼Œè¯·ç¨åå†è¯•",icon:"none"})}))})).catch((function(n){uni.hideLoading(),uni.showToast({title:"è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥",icon:"none"})}))}else uni.showToast({title:"è¯·æè¿°å® ç‰©ç—‡çŠ¶",icon:"none"});else uni.showToast({title:"è¯·é€‰æ‹©é¢„çº¦æ—¥æœŸ",icon:"none"})},formatTime:function(n){var t=n.getHours().toString().padStart(2,"0"),r=n.getMinutes().toString().padStart(2,"0");return"".concat(t,":").concat(r)}}};t.default=s},db04:function(n,t,r){"use strict";var e=r("bb80"),o=r("c435"),i=r("9e70"),a=r("f298"),s=r("862c"),c=e(a),d=e("".slice),l=Math.ceil,u=function(n){return function(t,r,e){var a,u,h=i(s(t)),f=o(r),p=h.length,m=void 0===e?" ":i(e);return f<=p||""===m?h:(a=f-p,u=c(m,l(a/m.length)),u.length>a&&(u=d(u,0,a)),n?h+u:u+h)}};n.exports={start:u(!1),end:u(!0)}},e062:function(n,t,r){"use strict";var e=r("8bdb");e({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{MAX_SAFE_INTEGER:9007199254740991})},e136:function(n,t,r){"use strict";r.r(t);var e=r("d71d"),o=r.n(e);for(var i in e)["default"].indexOf(i)<0&&function(n){r.d(t,n,(function(){return e[n]}))}(i);t["default"]=o.a},f298:function(n,t,r){"use strict";var e=r("497b"),o=r("9e70"),i=r("862c"),a=RangeError;n.exports=function(n){var t=o(i(this)),r="",s=e(n);if(s<0||s===1/0)throw new a("Wrong number of repetitions");for(;s>0;(s>>>=1)&&(t+=t))1&s&&(r+=t);return r}},f3f7:function(n,t,r){"use strict";r("53f7")}}]);